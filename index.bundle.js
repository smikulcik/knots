(()=>{"use strict";var t={523:(t,e,n)=>{n.d(e,{A:()=>s});var o=n(601),i=n.n(o),r=n(314),c=n.n(r)()(i());c.push([t.id,"",""]);const s=c},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",o=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),o&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),o&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,o,i,r){"string"==typeof t&&(t=[[null,t,void 0]]);var c={};if(o)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(c[a]=!0)}for(var u=0;u<t.length;u++){var h=[].concat(t[u]);o&&c[h[0]]||(void 0!==r&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=r),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),e.push(h))}},e}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function n(t){for(var n=-1,o=0;o<e.length;o++)if(e[o].identifier===t){n=o;break}return n}function o(t,o){for(var r={},c=[],s=0;s<t.length;s++){var a=t[s],u=o.base?a[0]+o.base:a[0],h=r[u]||0,l="".concat(u," ").concat(h);r[u]=h+1;var d=n(l),p={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=i(p,o);o.byIndex=s,e.splice(s,0,{identifier:l,updater:f,references:1})}c.push(l)}return c}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var r=o(t=t||[],i=i||{});return function(t){t=t||[];for(var c=0;c<r.length;c++){var s=n(r[c]);e[s].references--}for(var a=o(t,i),u=0;u<r.length;u++){var h=n(r[u]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}r=a}}},659:t=>{var e={};t.exports=function(t,n){var o=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={id:o,exports:{}};return t[o](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{function t(t,e,n,o){t.beginPath(),t.arc(e.x,e.y,n,0,2*Math.PI,!1),t.fillStyle=o,t.fill()}function e(t,e,n,i,r){return o(t,[e,e,n,n],i,r)}function o(t,e,n,o){const[i,r,c,s]=e;t.beginPath(),t.moveTo(i.x,i.y),t.lineWidth=n,t.strokeStyle=o,t.bezierCurveTo(r.x,r.y,c.x,c.y,s.x,s.y),t.stroke()}function i(t){const e=t.toElement.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}class r{constructor(t,e,n,o){this.x=t,this.y=e,this.color=n,this.radius=o}draw(e){t(e,{x:this.x,y:this.y},this.radius,this.color)}}class c{constructor(t){this.canvas=t,this.objects=[],this.cursor=new r(0,0,"red",5),t.onmousemove=t=>{const e=i(t);this.cursor.x=e.x,this.cursor.y=e.y,this.objects.forEach((e=>{"function"==typeof e.onmousemove&&e.onmousemove(t)})),this.draw()},t.onmousedown=t=>{this.objects.forEach((e=>{"function"==typeof e.onmousedown&&e.onmousedown(t)})),this.draw()},t.onmouseup=t=>{this.objects.forEach((e=>{"function"==typeof e.onmouseup&&e.onmouseup(t)})),this.draw()}}draw(){var t=this.canvas.getContext("2d");t.fillStyle="#eeeeee",t.strokeStyle="#000000",t.rect(0,0,800,600),t.fill();for(const e of this.objects)e.draw(t);this.cursor.draw(t)}addObject(t){this.objects.push(t)}}const s=[{x:250,y:230,a:{n:{i:1,x:"a"},c1:{x:284.4682713554273,y:223.92231378165744},c2:{x:102.27883704816881,y:256.04722665003953}},b:{n:{i:1,x:"b"},c1:{x:223.95277334996044,y:82.27883704816881},c2:{x:256.07768621834254,y:264.4682713554273}},top:"a"},{x:360,y:230,a:{n:{i:2,x:"a"},c1:{x:507.72116295183116,y:256.04722665003953},c2:{x:325.5317286445727,y:223.92231378165744}},b:{n:{i:2,x:"b"},c1:{x:353.92231378165746,y:264.4682713554273},c2:{x:386.04722665003953,y:82.27883704816881}},top:"b"},{x:300,y:325,a:{n:{i:0,x:"b"},c1:{x:275.2512626584708,y:300.25126265847086},c2:{x:391.9238815542512,y:416.9238815542512}},b:{n:{i:0,x:"a"},c1:{x:208.07611844574882,y:416.9238815542512},c2:{x:324.74873734152914,y:300.25126265847086}},top:"a"}];var a=n(72),u=n.n(a),h=n(825),l=n.n(h),d=n(659),p=n.n(d),f=n(56),x=n.n(f),y=n(540),v=n.n(y),P=n(113),b=n.n(P),m=n(523),w={};function g(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return{x:t.x/e,y:t.y/e}}function C(t,e){return{x:t.x-e.x,y:t.y-e.y,z:t.z?t.z-e.z:0}}function M(t,e){return{x:t.x+e.x,y:t.y+e.y,z:t.z?t.z+e.z:0}}function S(t,e){return{x:e.x*t,y:e.y*t,z:e.z?e.z*t:0}}function z(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)+((e.z||0)-(t.z||0))*((e.z||0)-(t.z||0)))}function A(t,e){const n=t.length,o=new Array(n*n),i=new Array(n),r=new Array(n);for(let e=0;e<n;e++)o[e]=t[e];for(let t=1;t<n;t++)for(let i=0;i<n-t;i++)o[t*n+i]={x:o[(t-1)*n+i].x*e+o[(t-1)*n+(i+1)].x*(1-e),y:o[(t-1)*n+i].y*e+o[(t-1)*n+(i+1)].y*(1-e)};for(let t=0;t<n;t++)i[t]=o[t*n+0];for(let t=n-1;t>=0;t--){const e=n-1-t;r[e]=o[t*n+e]}return[i,r]}function k(t,e){let n,o;for(let i=0;i<1;i+=.01){const r=z(t,E(e,i));(void 0===o||r<o)&&(n=i,o=r)}return n}function E(t,e){if(t.length<4)throw new Error("Need 4 points for bezier curve",t);if(e<0||e>1)throw new Error("t must be in 0, 1",e);return{x:t[0].x*Math.pow(1-e,3)+3*t[1].x*Math.pow(1-e,2)*e+3*t[2].x*(1-e)*Math.pow(e,2)+t[3].x*Math.pow(e,3),y:t[0].y*Math.pow(1-e,3)+3*t[1].y*Math.pow(1-e,2)*e+3*t[2].y*(1-e)*Math.pow(e,2)+t[3].y*Math.pow(e,3)}}function j(t,e,n,o,i,r){return[(n*i-e*r)/(t*i-o*e),(n*o-t*r)/(e*o-t*i)]}w.styleTagTransform=b(),w.setAttributes=x(),w.insert=p().bind(null,"head"),w.domAPI=l(),w.insertStyleElement=v(),u()(m.A,w),m.A&&m.A.locals&&m.A.locals;class T{constructor(t,e){this.knot=t,this.lineWidth=e,this.controlPointSelected=!1,this.selectableControlPoint=void 0,this.curvePinchPoint,this.curvePinchPointSelected=!1}onmousedown(t){void 0!==this.selectableControlPoint&&(this.controlPointSelected=!0),this.curvePinchPoint&&(this.curvePinchPointSelected=!0)}onmouseup(t){this.controlPointSelected=!1,this.curvePinchPointSelected=!1}onmousemove(t){const e=i(t);if(this.curvePinchPointSelected||(this.curvePinchPoint=function(t,e){const n=function(t,e){let n,o,i={i:0,x:"a"};do{const r=t[i.i],c=r[i.x].n,s=t[c.i],a=[r,r[i.x].c1,s[c.x].c2,s],u=k(e,a),h=E(a,u),l=z(e,h);(void 0===n||l<n)&&(o={pt:h,t:u,segment:a,start:{i:i.i,x:i.x},end:{i:c.i,x:c.x}},n=l),i=t[i.i][i.x].n}while(0!==i.i||"a"!==i.x);return o}(t,e);if(z(e,n.pt)<30)return n}(this.knot,e)),this.curvePinchPointSelected&&this.curvePinchPoint){const t=this.curvePinchPoint.t;this.curvePinchPoint.pt.x=e.x,this.curvePinchPoint.pt.y=e.y;const n=this.curvePinchPoint.segment,[o,i]=j(3*Math.pow(1-t,2)*t,3*(1-t)*t*t,this.curvePinchPoint.pt.x-n[0].x*Math.pow(1-t,3)-n[3].x*Math.pow(t,3),-1*t/(1-t),1,n[2].x-t*n[1].x/(1-t)),[r,c]=j(3*Math.pow(1-t,2)*t,3*(1-t)*t*t,this.curvePinchPoint.pt.y-n[0].y*Math.pow(1-t,3)-n[3].y*Math.pow(t,3),-1*t,1,n[2].y-t*n[1].y);n[1].x=o,n[1].y=r,n[2].x=i,n[2].y=c;const s=this.knot[this.curvePinchPoint.start.i],a=this.knot[this.curvePinchPoint.start.i][this.curvePinchPoint.start.x].c2,u=M(s,S(-1*z(a,s),g(C(n[1],s))));a.x=u.x,a.y=u.y;const h=this.knot[this.curvePinchPoint.end.i],l=this.knot[this.curvePinchPoint.end.i][this.curvePinchPoint.end.x].c1,d=M(h,S(-1*z(l,h),g(C(n[2],h))));l.x=d.x,l.y=d.y}else if(this.controlPointSelected&&this.selectableControlPoint){this.selectableControlPoint.p.x=e.x,this.selectableControlPoint.p.y=e.y;const t=this.knot[this.selectableControlPoint.i],n=this.knot[this.selectableControlPoint.i][this.selectableControlPoint.x]["c1"===this.selectableControlPoint.c?"c2":"c1"],o=M(t,S(-1*z(n,t),g(C(this.selectableControlPoint.p,t))));n.x=o.x,n.y=o.y}this.selectableControlPoint=void 0;const n=[];for(const t in this.knot){const e=this.knot[t];n.push({p:e.a.c1,i:t,x:"a",c:"c1"}),n.push({p:e.a.c2,i:t,x:"a",c:"c2"}),n.push({p:e.b.c1,i:t,x:"b",c:"c1"}),n.push({p:e.b.c2,i:t,x:"b",c:"c2"})}let o;n.forEach((t=>{const n=z(t.p,e);n<30&&(void 0===o||n<o)&&(this.selectableControlPoint=t,o=n)}))}draw(n){const i=this.knot;for(const t of["bottom","top"]){let e={i:0,x:"a"},r=this.lineWidth,c=8;do{const s=i[e.i],a=s[e.x].n,u=i[a.i],h=s[e.x].c1,l=u[a.x].c2,[d,p]=A([s,h,l,u],.5);(s.top!==e.x&&"bottom"===t||s.top===e.x&&"top"===t)&&(o(n,d,r,"#000000"),o(n,d,r-3,"#ffffff")),(u.top!==a.x&&"bottom"===t||u.top===a.x&&"top"===t)&&(o(n,p,r,"#000000"),o(n,p,r-3,"#ffffff")),e=i[e.i][e.x].n,c--}while((0!==e.i||"a"!==e.x)&&c>0)}for(const o of i){const i=o.a.c1,r=o.a.c2,c=o.b.c1,s=o.b.c2;e(n,o,i,1,"#008800"),t(n,i,3,"#008800"),e(n,o,r,1,"#008800"),t(n,r,3,"#008800"),e(n,o,c,1,"#008800"),t(n,c,3,"#008800"),e(n,o,s,1,"#008800"),t(n,s,3,"#008800")}this.selectableControlPoint&&new r(this.selectableControlPoint.p.x,this.selectableControlPoint.p.y,this.controlPointSelected?"blue":"green",10).draw(n),this.curvePinchPoint&&new r(this.curvePinchPoint.pt.x,this.curvePinchPoint.pt.y,this.curvePinchPointSelected?"blue":"orange",5).draw(n)}}document.body.appendChild(function(){const t=document.createElement("canvas");return t.setAttribute("id","content"),t.setAttribute("width","800"),t.setAttribute("height","600"),t}()),window.onload=()=>{const t=document.getElementById("content"),e=new c(t);e.addObject(new T(s,6)),e.draw()}})()})();